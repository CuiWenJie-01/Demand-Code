# 20251113gcl修改

# 学科通用配置【英语、政治（道德与法治）、历史、语文、文综、地理、信息科技】
subjects:
  英语:
    question_types: "选择、填空、完形填空、阅读理解、翻译、短文改错、写作"
    extract_qa_rules: |-
      5. 英语学科特定规则:
        - 严禁提取听力题：若题目涉及听力材料（如“听下面一段对话”、“听力原文”等），即使题干完整，也必须跳过不提取。
        - 写作题处理：作文题仅当文本中明确给出参考范文、标准答案或详细评分要点时，才提取答案；否则，即使题干完整，也视为“未找到对应答案”。
        - 完形填空题下划线补全：若题干为完形填空但无下划线，需根据题号序列（如 1, 2, 3...）在背景知识中对应位置补全 `<u>____</u>`；若无法补全，则整题丢弃。
    check_rules: ""
  政治:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: ""
  道德与法治:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: ""
  历史:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: ""
  语文:
    question_types: "选择、填空、简答、阅读理解、文言文阅读题、作文题"
    extract_qa_rules: |-
      5. 语文学科特定规则:
        - 答案必须有明确标识：仅当答案前有“【答案】”、“答案：”等明确标记时，才视为有效答案；否则判定为“未找到对应答案”。
        - 背景知识完整性要求更高：必须包含文末的来源说明（如“选自《XXX》”、“有删改”等），若缺失则视为背景知识不完整，整题丢弃。
    check_rules: |-
      - 选择题题干未直接标注核心答题要求如“选出与题干中 XX 含义相同 / 不同的一项”，需结合选项反向推导意图的题目，判定题目不可用。
        - 题目内容或题目背景知识要求对加点字、加点词、下划线内容、波浪线内容等进行考察，但是题目中没有用<u></u>标识包围这些需要标记的内容，导致作答要求不明确的，判断该题不可用。
  文综:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: ""
  地理:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: |-
      - 若题目涉及公式计算，并且公式本身不正确/不符合题目意图/公式的书写表达有错误，判定题目不可用。
  信息科技:
    question_types: "选择、填空、简答、材料题、判断题"
    extract_qa_rules: ""
    check_rules: |-
      - 若题目属于操作题（如要求进行软件操作、代码编写运行、系统配置等需实际操作的题目），判定题目不可用。
        - 若题目中出现具体代码，并且代码的格式不正确（如缺乏缩进），判定题目不可用。
# Prompt 模板
prompts:
  1_ocr:
    template: |
      你是一个OCR(Optical Character Recognition)专家，现在给你一张图，请你完全遵从原文内容，将图片中的内容识别为文本。

      ## **核心规则（杜绝推导，绝对识别）** ：
      1. **杜绝推导**：  
        - 图片中可能存在一些题目，不要尝试解答，完全遵照图片内容，不要进行推导加工。
        - 图片中展示的字词有可能会违反你的知识惯性，**杜绝受常识或认知惯性影响**，严格按照图片，忠实地抄写下来。
      2. **特殊元素定义**：
        一些无法直接被识别为文本的特殊元素，先判断属于插图/表格/下划线之中的哪一类，然后按以下约定处理。
        - 图：对页面中题目使用的插图，统一用<fig>（描述性文本）</fig>格式表示，具体要求见第3条。
        - 表：有表头、行列等明确表格结构的内容，用标准HTML表格格式输出。
        - 下划线：文字下方有横线、波浪线、加点等特殊指示符号，统一用<u>xxxx</u>符号进行包围，若下划线上的内容为空，使用<u>____</u>。若连续出现多个相邻的空下划线，合并为单个<u>____</u>。
      3. **题目使用的插图**
        - 统一用<fig>（描述性文本）</fig>格式表示，仅作总结性简单描述，例如<fig>（图3：思维导图，展示数据处理流程）</fig>，**严禁提取插图中的文字、表格和符号元素**。
        - 插图大多数情况下会有“图1”“第7题图”“Fig3.5”等表明图片顺序或属于哪些题目的标注，如果存在图片标注，则把标注归纳入插图的描述性文本中，例如<fig>（第7题图：一个word文档中的表格，带有批注）</fig>。
        - 识别插图有几张，并列排版的不同插图需要分开识别，例如<fig>（插图1）</fig> <fig>（插图2）</fig>，不能合并在一对标签中。

      仅输出连贯的ocr结果，不要有多余的字符。
    template_edu: |
      你是一个OCR(Optical Character Recognition)专家，现在给你一张图，它是书籍中的某一页，请你分析页面排版，识别其中文字，将图片中的内容识别为文本。

      ## **核心规则（杜绝推导，绝对识别）** ：
      1. **杜绝推导**：  
        - 图片中可能存在一些题目，不要尝试解答，完全遵照图片内容，不要进行推导加工。
        - 图片中展示的字词有可能会违反你的知识惯性，**杜绝受常识或认知惯性影响**，严格按照图片，忠实地抄写下来。
      2. **特殊元素定义**：
        一些无法直接被识别为文本的特殊元素，先判断属于插图/表格/下划线之中的哪一类，然后按以下约定处理。
        - 图：对页面中题目使用的插图，统一用<fig>（描述性文本）</fig>格式表示，仅作总结性简单描述，例如<fig>（思维导图:分析和概括了数据处理流程）</fig>，**严禁提取插图中的文字、表格和符号元素**。
        - 表：有表头、行列等明确表格结构的内容，用标准HTML表格格式输出。
        - 加粗：加粗字体使用**xxxx**包围。
        - 下划线：文字下方有横线、波浪线、点线等特殊指示符号，统一用<u>xxxx</u>符号进行包围，若下划线上的内容为空，使用<u>____</u>。若连续出现多个相邻的空下划线，合并为单个<u>____</u>。
      3. **排版识别**
        - 识别图片是单栏排版还是双栏排版。
        - 识别图片是上下连贯还是上下分区。
        - 识别页眉页尾，不进行文本提取。
        - 识别各级标题。
        - 识别图表元素分布。
        - 识别文本顺序。
      4. **内容筛选（聚焦有意义信息）**:
        - 请忽略以下类型的无意义内容：
          - - 页眉、页脚：包括页码、课程名称、学案号、机构Logo、二维码等，这些内容通常位于页面的最顶部或最底部，且与主要内容无关。
          - - 纯装饰性元素：例如标题旁边的与核心题干不相关的图案、分割线、二维码等。
          - - 与核心学习内容不相关的次要信息，例如出版商信息、版权说明、“扫码看视频讲解”“智能错题本”等推广性文字或二维码。
        - 请聚焦识别以下类型的核心、有意义内容：
          - - 正文中所有章节标题（如“一、识字”）、正文内容、例题、详细解释和说明等。
          - - 正文中所有无法被直接识别为文本的特殊元素，按照**特殊元素定义**处理。

      仅输出连贯的ocr结果，不要有多余的字符。
      

  2_extract_qa:
    template: |
      你是一个严格基于文本内容的{subject}学科题目答案匹配工具。必须完全遵从文本内容，从连续多页文本中提取题干完整并且包含明确答题指令的题目，如果存在匹配的答案则需要提取答案内容，并将答案和题目按照题号进行匹配，**严禁改变题目和答案内容**，仅提取匹配的问题和答案内容即可，**禁止擅自作答**。

      ## **核心规则（杜绝推导，绝对匹配）** ：
      1. **题目来源唯一化**： 
        - 题目内容必须直接来自文本中明确呈现且完整的题目部分，禁止任何形式的推测、补充（例如：在填空题中，即使知道空格处应该填什么内容，也要按照题目的原样保留空格或下划线）。 
        - 若文本中的题目题干缺失、不完整或未明确给出解题指令，则不进行识别提取。
        - 类似定理、引理的文本不需要识别。
      2. **答案来源唯一化**：  
        - 所有题目答案必须直接来自文本中明确标注的答案内容（如题目下方的填空答案、选择题选项后的字母、证明题的完整证明过程等）。  
        - **禁止根据题目逻辑、已有知识或解题步骤反推答案**（例如：在选择题中，即使知道这题的答案是什么，若文本中未显示答案，也必须判定“未找到对应答案”）。 
      3. **特殊元素定义**：
        - 所有文本都是图片ocr的结果。
        - 图：题目使用的插图，统一用<fig>（描述性文本）</fig>格式表示，含对插图内容的客观简洁的描述。
        - 表：有表头、行列等明确表格结构的内容，用标准html格式表示。
        - 下划线：文字的下方有横线、波浪线、点线等特殊指示符号，统一用<u>xxxx</u>符号进行包围，若下划线上的内容为空，使用<u>____</u>指代。
      4. **禁止要求**:
        - 禁止提取水印、试卷描述等与问题和答案无关的信息，如“xx网”、“高分不愁”、“XX考试试卷”、“本试卷分第I 卷（选择题）和第Ⅱ卷（非选择题）两部分”。
      {extract_qa_rules}

      谨记核心规则，并按照以下步骤一步步思考，最终以json格式输出识别到的内容。

      ### 一、题干类型判断
      1. 判断文本中是否有明确的题目，通常来说，{subject}学科的题型包括：{question_types}。
      2. 判断题目的题干是**共享题干**还是**独立题干**，共享题干存在一段背景知识（如阅读材料、图表、案例描述等），一个或多个连续小问题依赖背景知识作答。

      ### 二、背景知识识别提取
      1. 若题干为共享题干，提取背景知识；若题干为独立题干，则无需识别题目背景知识。
      2. 如果该题为阅读理解、材料题，那么一定存在共享题干，务必提取共享的题干材料作为**题目背景知识**，否则整题丢弃。
      3. **位于题目之后的背景知识不属于本道题目的范围**，例如<背景知识A/子题1/背景知识B/子题2/子题3>，将<背景知识A/子题1>和<背景知识B/子题2/子题3>分开提取，作为两道题目。
      4. 判断题目背景知识中是否包含图、表、下划线。
      5. 背景知识可能存在跨页情况，若文本中的**背景知识不完整**，且上下页中都找不到则跳过该题不输出。

      ### 三、题目内容识别提取
      1. 识别题目编号，每个题目编号唯一，严格按照文本中的原始编号格式提取题目编号。
      2. 文本以“第 x 页”作为分隔符，严格识别题目在当前输入的这批文本的第几页，并将结果输出到"题目位于第几张图片"字段。
      3. 判断本页文本是否全为答案，例如页面中明确有"solution"“试题答案”等标识，并且在之前的页面中找不到匹配的问题，则不提取本页内容。
      4. 判断题目是否包含图、表、下划线。
      5. 判断关联性，若题目需要在其他题目或答案基础上作答，则判断该问题与其他题目有关联。
      6. 注意，若题干类型为共享题干，对应的多个子问题应是连续的，紧接在关联的背景知识后面，对应的多个子问题需要分别识别和输出。
      7. 提取题目内容：
        - 若题目中包含了答案，以及有明确指向答案的符号（例如判断题直接给出了对错，选择题通过下划线标记直接指向了正确选项等），将题目和答案分开提取，**必须将答案以及指向答案的标记从题目中删除**。
        - 题目内容和语言需要与文本中的题目保持一致，若题目是英文，则输出内容也是英文，确保输出文本一致性。
        - 不能缺失题目信息，例如选择题需要有具体的选项、简答题需要有作答要求。
        - 对于选择题，如果ocr文本中的选项顺序被打乱，需要按照顺序提取选项。
        - 不提取原始题干前后的关于分值说明、题目来源等无关信息，例如题目前的“（八校联考试题）”、“单选题，每题3分”。
        - 若插图的描述中明确指向了某道题目，例如<fig>（第7题图：思维导图）</fig>，需要把这个插图的描述与题目一起提取，不能提取不属于这道题目的插图信息。
        - 若文本中的**题目不完整**则跳过该题不输出。
      8. 需要在题干前添加前缀的情况：
        - 若单看题目无法明确提问意图，查找这道题在上文是否有对应作答要求，添加到原始题干前。
        - 针对判断题，在提取判断题题目内容时，**在原始题干前添加“判断题：”前缀**，如果是英文的判断题则添加"True or False:"前缀，以明确提问意图。

      ### 四、答案内容识别提取
      1. 判断第二步中识别到的题目是否有与之对应的答案，答案和题目应该是分离的，若题目中包含了答案，将答案单独提取出来。
      2. 文本以“第 x 页”作为分隔符，严格识别答案在当前输入的这批文本的第几页，并将结果输出到"答案位于第几张图片"字段，若未找到对应答案，则为第0页。
      3. 如果存在题目未匹配到相应的答案，则该题目的**对应答案**为未找到对应答案；如果答案不完整，则该题目的**对应答案**为答案不完整。
      4. 判断答案是否包含图、表、下划线。
      5. 提取答案内容：
        - 答案内容和语言需要与文本中的答案保持一致，若答案是英文，则输出内容也是英文，确保输出文本一致性。
        - 仅提取最终答案，不提取具体解题过程。

      ===============================================

      ## 最终输出
      1. 每道题目及其对应答案等相关信息，在同一行json中输出。识别到多道题目，则输出多行json，按照题目在文本中的顺序输出json。
      2. 对于共享题干的题目，其json格式如下:
      ``` json
      {{"题目背景知识": str, "背景知识是否含图"："是/否", "背景知识是否含表"："是/否", "背景知识是否含下划线"："是/否", "sub_qa":[{{"题目编号": str, "题目内容":str, "对应答案": str, "题目位于第几张图片": int, "答案位于第几张图片": int, "题目是否含图": "是/否", "题目是否含表": "是/否", "题目是否含下划线":"是/否",  "是否关联其他题目": "是/否", "答案是否含图": "是/否", "答案是否含表": "是/否", "答案是否含下划线":"是/否"}}, ...]}}
      ```
      3. 对于独立题干的题目，其json格式如下：
      ``` json
      {{"题目编号": str, "题目内容":str, "对应答案": str, "题目位于第几张图片": int, "答案位于第几张图片": int, "题目是否含图": "是/否", "题目是否含表": "是/否", "题目是否含下划线":"是/否",  "是否关联其他题目": "是/否", "答案是否含图": "是/否", "答案是否含表": "是/否", "答案是否含下划线":"是/否"}}
      ```

      ## 示例
      1. 给定文本：“\n学科网\nxxx.com\n23. 阅读材料，回答问题。（16分）\n  背景材料A(一个表格)\n  （1）请你填写表格中③处的内容。\n  背景材料B（一段文字）\n  （2）结合材料，分析xxx。\n  （3）材料中故事发生的背景是什么？\n  24. 选择与题目的词语意思最相近的一项（每题3分）\n  （1）词语xxxx（B）\n  A.词语a\n  C.词语c\n  B.词语b\n  D. 词语d\n”
      2. 思考过程：
        - 文本中找到明确的题目，23题有题目编号、背景知识和3道小题，小题依赖于两段阅读材料作答，判断题干属于共享题干。小题依赖的背景材料不同，根据背景知识识别提取的第3条原则（位于题目之后的背景知识不属于本道题目的范围），我需要把它们分开提取。拆分后单看题目，提问意图明确，根据题目内容识别提取的第8条原则的第一小点（若单看题目无法明确提问意图，查找这道题在上文是否有对应作答要求，添加到原始题干前），虽然在上文找到了对应作答要求“阅读材料，回答问题”，但仅看拆分后的题目本身，有明确要求结合材料进行分析和解答，提问意图已经明确，不需要在原始题干前添加前缀。
        - 文本中找到明确的题目，24（1）题不依赖背景知识，判断题干属于独立题干。单看题目，无法明确提问意图，根据题目内容识别提取的第8条原则的第一小点，在上文查找到对应作答要求“选择与题目的词语意思最相近的一项”，添加到原始题干前，以明确题目的提问意图。题目中包含了答案，根据题目内容识别提取的第7条原则的第一小点（将题目和答案分开提取），我需要把答案从题目中删除，避免题目中泄露答案。该题属于选择题，根据题目内容识别提取的第7条原则的第四小点（如果选项顺序被打乱，按照顺序提取选项），我需要按照A/B/C/D的顺序提取四个选项。
      3. 提取结果（省略版，仅作示意）：
        ``` json
        {{"题目背景知识":"背景材料A(一个表格)", ……, "sub_qa":[{{"题目编号": "23(1)", "题目内容": "请你填写表格中③处的内容。", ……}}]}}
        {{"题目背景知识":"背景材料B（一段文字）", ……, "sub_qa":[{{"题目编号": "23(2)", "题目内容": "结合材料，分析xxx。", ……}}, {{"题目编号": "23(3)", "题目内容": "材料中故事发生的背景是什么？", ……}}]}}
        {{"题目编号": "24(1)", "题目内容":"选择与题目的词语意思最相近的一项:\n词语xxxx（）\n  A.词语a\n  B.词语b\n  C.词语c\n  D. 词语d", "对应答案": "B",……}}
        ```
      
      最后再次强调一下**核心规则（杜绝推导，绝对匹配）**：你只需要准确提取对应的题目及答案，严格禁止自行补充或者修改，除了题目中包含了答案时必须把答案从题目中删除/题意不明时在题干前缀添加必要的作答要求，其他情况下严格禁止随意修改**题目内容**及**对应答案**，题目及答案必须要和文本中的内容保持一致。对于特殊元素的处理，遵从核心规则中的约定。

      以下是给定文本：


  3_check_availability:
    # 通用模板
    template: |
      你需要根据要求对给定的{subject}题目及其答案进行可用性检查。

      ### 题目的可用性要求
      1. 题目表述清晰、完整，没有明显的截断/缺失信息/明显拼写和语法错误影响理解，适合作为{subject}题目。
      2. 选择题的题干完整，选项按顺序排列且大于等于4个，所有选项的内容清晰完整，不能存在空白的选项。
      3. 填空题的题干完整，提供有足够的提示或上下文线索，空白位置使用了括号或者<u>____</u>明确标出，确保答案唯一或高度确定。
      4. 判断题的题干中明确表示这是判断题，或者以选择题形式出现（例如选项为A.正确 B.错误）。
      5. 简答题、材料题、阅读理解、写作等题型，背景材料完整无截断，问题表述清晰，作答要求明确。
      6. 如果存在以下情况之一，直接判定题目不可用：
        - 题目有明显的逻辑错误/意图不清晰，以及语义不连贯/格式混乱/排版复杂/缺乏作答要求，导致题目理解困难、单看题目无法作答。
        - 题目中包含了答案导致答案被泄露，例如判断题直接给出了对错，选择题直接展示或通过标记指向了正确选项。
        - 用于解答题目的重要提示信息缺失，例如要求解释下划线句子的含义，但未找到有下划线或被<u></u>标记包围的对应句子。
        - 题目明确要求根据背景材料回答问题，例如“阅读段落3，回答以下问题”“结合材料回答”等，但对应背景材料缺失。
        - 题目被某些文字或符号截断，通常是题目编号、试题来源、页眉页脚或水印等文字，导致题目文本不完整不连贯。
        - 题目依赖特定图像作答，例如题目中要求“根据下图回答”“如图所示”“下图展示了……”等，直接判定题目不可用。
        - 题目依赖特定表格作答，但对应表格没有给出，判定题目不可用。
        {check_rules}
      注意：需要**单独根据题目**判断解题意图是否清晰，杜绝结合答案或选项反推题目意图，若题目缺乏作答要求，明显意图不清晰，导致单看题目无法作答的情况，判定题目不可用。

      ### 答案的可用性要求
      1. 如果没有提供答案，跳过答案检查。
      2. 对于选择题、填空题、判断题等客观题，答案唯一确定，否则判定答案不可用。
      3. 对于简答题、材料题、阅读理解、写作等主观题，答案完整、逻辑通顺、能够回答问题，否则判定答案不可用。

      根据题目和答案的可用性要求进行逐条判断，并给出详细的判断理由；从以下题目类型里选取一个最合适的标签：{question_types}、其他。禁止生成不属于题目类型中的标签。
      
      提供的题目为：
      {query}

      提供的答案为：
      {answer}

      如果有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【答案是否可用】:是/否,【题目类型】:str,【详细的判断理由】:str

      如果没有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【题目类型】:str,【详细的判断理由】:str

    # 接受图表题
    template_special: |
      你需要根据要求对给定的{subject}题目及其答案进行可用性检查。

      ### 题目的可用性要求
      1. 题目表述清晰、完整，没有明显的截断/缺失信息/明显拼写和语法错误影响理解，适合作为{subject}题目。
      2. 选择题的题干完整，选项按顺序排列且大于等于4个，所有选项的内容清晰完整，不能存在空白的选项。
      3. 填空题的题干完整，提供有足够的提示或上下文线索，空白位置使用了括号或者<u>____</u>明确标出，确保答案唯一或高度确定。
      4. 判断题的题干中明确表示这是判断题，或者以选择题形式出现（例如选项为A.正确 B.错误）。
      5. 简答题、材料题、阅读理解、写作等题型，背景材料完整无截断，问题表述清晰，解答指令明确。     
      6. 如果存在以下情况之一，直接判定题目不可用：
        - 题目有明显的逻辑错误/意图不清晰，以及语义不连贯/格式混乱/排版复杂/缺乏作答要求，导致题目理解困难、单看题目无法作答。
        - 题目中包含了答案导致答案被泄露，例如判断题直接给出了对错，选择题直接展示或通过标记指向了正确选项。
        - 用于解答题目的重要提示信息缺失，例如要求解释下划线句子的含义，但未找到被<u></u>标记包围的对应句子。
        - 题目明确要求根据背景材料回答问题，例如“阅读段落3，回答以下问题”“结合材料回答”等，但对应背景材料缺失。
        - 题目被某些文字或符号截断，通常是题目编号、试题来源、页眉页脚或水印等文字，导致题目文本不完整不连贯。
        {check_rules}
      7. 若题目依赖特定图像或特定表格作答，根据以下原则判断：
        - 题目使用的图像通常是由<fig></fig>包围对图片的简单描述，例如<fig>（一个excel界面，展示一张表格）</fig>；
        - 题目使用的表格通常是由<table></table>包围标准HTML表格格式；
        - 图像仅允许简单文字描述，若题目明确表明使用的是图像，例如题目中要求“根据下图回答”“如图所示”，但被识别成了表格<table></table>，判定题目不可用；
        - 若题目依赖特定图像或特定表格作答，但未找到对应<fig></fig>图像或<table></table>表格，检查题目满足其他所有可用条件后，也要判定题目可用。
        
      注意：需要**单独根据题目**判断解题意图是否清晰，杜绝结合答案或选项反推题目意图，若题目缺乏作答要求，明显意图不清晰，导致单看题目无法作答的情况，判定题目不可用。

      ### 答案的可用性要求
      1. 如果没有提供答案，跳过答案检查。
      2. 对于选择题、填空题、判断题等客观题，答案唯一确定，否则判定答案不可用。
      3. 对于简答题、材料题、阅读理解、写作等主观题，答案完整、逻辑通顺、能够回答问题，否则判定答案不可用。

      根据题目和答案的可用性要求进行逐条判断，并给出详细的判断理由；从以下题目类型里选取一个最合适的标签：{question_types}、其他。禁止生成不属于题目类型中的标签。
      
      提供的题目为：
      {query}

      提供的答案为：
      {answer}

      如果有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【答案是否可用】:是/否,【题目类型】:str,【详细的判断理由】:str

      如果没有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【题目类型】:str,【详细的判断理由】:str

    template_chinese: |
      根据要求对给定的{subject}题目及其答案进行可用性检查。

      ### 题目的可用性要求
      1. 题目表述清晰、完整，没有明显的截断/缺失信息/明显错别字影响理解，适合作为{subject}题目。
      2. 选择题的题干完整，选项按顺序排列且大于等于4个，所有选项的内容清晰完整，不能存在空白的选项。
      3. 填空题的题干完整，提供有足够的提示或上下文线索，空白位置使用了括号或者<u>____</u>明确标出，确保答案唯一或高度确定。
      4. 判断题的题干中明确表示这是判断题，或者以选择题形式出现（例如选项为A.正确 B.错误）。
      5. 简答题、材料题、阅读理解、写作等题型，背景材料完整无截断，问题表述清晰，作答要求明确。
      6. 如果存在以下情况之一，判定题目不可用：
        - 题目明显不属于语文学科的范围，例如英文题目或题目要求进行数学公式计算。
        - 题目有明显的逻辑错误/意图不清晰，以及语义不连贯/格式混乱/排版复杂/缺乏作答要求，导致题目理解困难、单看题目无法作答。
        - 题目中包含了答案导致答案被泄露，例如判断题直接给出了对错，选择题直接展示或通过标记指向了正确选项。
        - 用于解答题目的重要提示信息缺失，例如要求解释下划线句子/加点字的含义，但未找到被<u></u>标记包围的对应字句。
        - 题目明确要求根据背景材料回答问题，例如“阅读段落3，回答以下问题”“分析这篇文章”等，但对应背景材料缺失。
        - 题目被某些文字或符号截断，通常是题目编号、试题来源、页眉页脚或水印等文字，导致题目文本不完整不连贯。
        - 题目依赖特定图像作答，例如题目中要求“根据下图回答”“如图所示”“下图展示了……”等，直接判定题目不可用。
        - 题目依赖特定表格作答，但对应表格没有给出，判定题目不可用。
      7. **需要仔细检查的方面：**
        - 题目要求对加点、下划线、波浪线、高亮的特定字词或句子等进行考察，或者比较隐晦的要求“解释词义”，但题目内容或题目背景知识中没有用<u></u>标识包围被考察的字词或句子；
        - 存在明显的错别字，并且题目不属于对错别字进行改错的题目；
        - 语句不通顺，存在明显的逻辑错误；
        - 题目表述存在明显的术语错误以及知识性错误；
        - 存在上述任一方面的问题，直接判定题目不可用。

      注意：需要**单独根据题目**判断解题意图是否清晰，杜绝结合答案或选项反推题目意图，若题目缺乏作答要求，明显意图不清晰，导致单看题目无法作答的情况，判定题目不可用。

      ### 答案的可用性要求
      1. 如果没有提供答案，跳过答案检查。
      2. 对于选择题、填空题、判断题等客观题，答案唯一确定，否则判定答案不可用。
      3. 对于简答题、材料题、阅读理解、写作等主观题，答案完整、逻辑通顺、能够回答问题，否则判定答案不可用。
      4. **需要仔细检查的方面：**
        - 答案中存在明显的错别字；
        - 答案的语句明显不通顺，存在逻辑错误，无法回答题目；
        - 存在上述任一方面的问题，直接判定答案不可用。

      根据题目和答案的可用性要求进行逐条判断，并给出详细的判断理由；从以下题目类型里选取一个最合适的标签：{question_types}、其他。禁止生成不属于题目类型中的标签。
      
      提供的题目为：
      {query}

      提供的答案为：
      {answer}

      如果有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【答案是否可用】:是/否,【题目类型】:str,【详细的判断理由】:str

      如果没有答案，请按照如下格式进行输出：
      【题目是否可用】：是/否,【题目类型】:str,【详细的判断理由】:str

# 自动化质检
Prompt_check:
  template-多轮1: |
    你收到一组连续的图片，把图片中的内容逐字完整抄写下来，拼成一段完整的文本。

    ## 注意事项：
    1. 图片中存在一些题目，不要尝试解答，完全遵照图片内容，不作解释、不修正、不补全，**严格禁止自行修改**。
    2. 图片中展示的字词有可能会违反你的知识惯性，**杜绝受常识或认知惯性影响**，你只需要把每一个字都忠实地抄写下来。例如图片中是“流木”，绝不能抄成“流水”
    3. 图片中展示的完整题目内容，题目使用的一些无法被识别为文本的特殊元素，按以下约定处理。
      - 图：对题目使用的插图，统一用<fig>符号占位，不识别插图内容
      - 表：有表头、行列等明确表格结构的内容，用标准HTML表格格式输出
      - 下划线：文字下方有横线、波浪线、加点等特殊标记，统一用<u>xxxx</u>符号进行包围，若下划线上的内容为空，使用<u>____</u>
    4. 按顺序阅读和抄写多张图片，确保抄写拼接后能够保持原文连续性。

  template-多轮2: |
    现在提供一道从这些图片中抽取的题目。
    你的任务是：根据图片和上一步的抄写内容，检查提供的题目，严格比对题目与抄写内容/图片的一致性，按输出格式要求输出判断结果。

    ##注意事项
    1. 若存在以下情况，输出【图片中是否有匹配的题目】为“否”：
      - 在抄写内容和所有图片中均无法找到与提供的题目内容匹配的题目；
      - 题目内容明显被截断（如出现在图片边缘且不完整），且后续图片无延续；
      - 图片变形/模糊/无法识别。
    2. 背景知识 / 作答指令的定义和处理：
      - 背景知识是指一段背景知识模块，例如一段阅读材料、图表、案例描述等，被一个或多个连续子题引用。若提供的题目中要求“结合材料作答”“”阅读这篇文章回答以下问题“等，其上文中必定存在对应的背景知识；
      - 若题目明确引用了背景知识（如题目要求“结合材料作答””文章表达了什么中心思想“），但提供的题目中缺失该背景知识，且抄写内容和图片中确实存在对应背景知识，则判定【背景知识是否缺失】为“是”；
      - 如果没有引用背景知识，提供的题目提问意图清晰，作答指令明确，单看题目就可以作答，判定【背景知识是否缺失】为“否”。
      - 作答指令是指题目中给出明确的答题要求，通常比较简短（例如“结合材料作答””选出以下最符合题意的一项“”判断题：“等）；背景知识是一段被引用材料（例如一段新闻稿、一篇文章），本身并不给出明确的答题要求。
    3. <原始完整题目>的定义：
      - 原始完整题目指从抄写内容中截取的、与提供的题目匹配的完整答题单元，包含题干及该题型所必需全部组成部分（如选择题含题干与全部选项、材料题含背景知识与设问等），且内容连贯完整、可独立作答的一段题目文本；
      - 若题目引用了背景知识，原始完整题目必定包含一段背景知识和紧接着的一个或多个连续子题。
    4. 严格以图片展示和抄写的<原始完整题目>为准，找出<提供的题目>中存在的差异：
      - 文字：以图片和抄写内容为准，逐字核对提供的题目找出所有错别字、多余字句、缺漏字句；
      - 强调标记：以图片和抄写内容为准，逐个核对提供的题目中文字下方的横线、波浪线、加点等进行视觉强调标记的位置，同时判断这些被强调的字句与题目作答要求是否有直接关系；
      - 插图：提供的题目使用的插图会统一用<fig>（描述性文本）</fig>格式表示，不需要检查插图。
      - 表：以图片和抄写内容为准，核对提供的题目中的表格格式、文字内容。
    5. 检查一致性步骤：
      - 第一步，在抄写内容中找到提供的题目对应的原始出处，并定位到图片中的位置。
      - 第二步，在抄写内容中检查这道题目的上文，看是否有关联的背景知识，从抄写内容中提取出<原始完整题目>。
      - 第三步，以抄写内容和图片为准，将提供的题目和<原始完整题目>进行仔细对比，找出所有差异的地方。
      - 第四步，根据差异的地方，判断提供的题目和图片展示的<原始完整题目>是否一致，并给出详细判断理由。

    ## **判断一致性原则**
    1. **需要仔细对比的情况**：
      - 在提供的题目中，多余、缺漏字句是否影响题目意图、是否影响题目解答；
      - 在提供的题目中，横线、波浪线、加点字等强调标记是否在正确的位置，例如题目要求填空但缺乏填空的位置，会影响题目解答。
    2. 决定一致性判断的情况：
      - 未在图片以及抄写内容中找到跟提供的题目匹配的内容；
      - 文字增删导致语义变化、知识性术语错误（如“不正确的是”变成“正确的是”）；
      - 与作答要求有直接关系、用于提示答题重点的关键字句，其加点/加粗/下划线等强调标记缺失（如要求解释下划线句子的意思，但题目没有标记句子的位置）；
      - 缺失背景知识，题目缺乏作答必需的背景知识，导致单看题目无法作答（如题目要求结合材料作答，但材料没有给出）；
      - 选择题缺少选项，或者选项内容空白；
      - 填空题缺少下划线或括号标出的填空位置，无法确定填空位置，导致无法作答；
      - 提供的题目被某些文字或符号截断，在图片中通常是题目编号、页眉页脚或水印等文字，导致提供的题目文本不完整不连贯；
      - 提供的题目中存在错别字，与抄写内容和图片中不一致；
      - 存在上述任何一种情况，直接判定【题目和图片是否一致】为“否”。
    3. 不影响一致性判断的轻微差异：
      - 提供的题目缺少题目编号；
      - 多余、缺漏字句但未影响题意，例如多了一个“的”字；
      - 题目前面添加了与题目相关的作答指令，例如选择题前面添加了“从以下选项中选出正确的一项”/判断题前面添加了“判断题：”前缀/填空题前面添加了“根据提示补全语句”等；
      - 横线、波浪线、加点、加粗字体等使用了其他形式进行强调标记，例如使用下划线表示或使用<u></u>标记包围，但都在正确的位置；
      - 横线、波浪线、加点、加粗字体等没有进行强调标记，但与题目作答要求无直接关系，不影响整体题意和题目作答；
      - 若背景知识属于约300字以上的大段长文本，背景知识中存在局部缺漏字句，但不属于与作答要求有直接关系的关键字句，不影响整体题意和题目作答；
      - latex字符渲染方式、标点符号、有无空格或者空格长度不同等轻微差异；
      - 只存在上述的轻微差异，未影响最终题意和作答要求，判定【题目和图片是否一致】为“是”。

    ## 最终输出格式要求：
    【题目和图片是否一致】：是/否，【图片中是否有匹配的题目】: 是/否，【背景知识是否缺失】: 是/否，【题目和图片的差异】: str，【详细判断理由】: str

    **重要提示**：
    严格遵循视觉证据，一切按照图片和抄写截取出来的<原始完整题目>内容为准。
    提供的题目里**肯定跟图片和<原始完整题目>有差异**，不会完全一致，大部分差异都在文字内容上，如实报告所有发现的差异，输出到【题目和图片的差异】。
    有差异不一定会影响一致性，根据**判断一致性原则**进行推理和判断，并输出理由到【详细判断理由】。

    按照指定的步骤一步步执行，严格按照最终输出格式要求给出回复。

    以下是<提供的题目>：
    {query}

  template-地理信息多轮2: |
    现在提供一道从这些图片中抽取的题目。
    你的任务是：根据图片和上一步的抄写内容，检查提供的题目，严格比对题目与抄写内容/图片的一致性，按输出格式要求输出判断结果。

    ##注意事项
    1. 若存在以下情况，输出【图片中是否有匹配的题目】为“否”：
      - 在抄写内容和所有图片中均无法找到与提供的题目内容匹配的题目；
      - 题目内容明显被截断（如出现在图片边缘且不完整），且后续图片无延续；
      - 图片变形/模糊/无法识别。
    2. 背景知识 / 作答指令的定义和处理：
      - 背景知识是指一段背景知识模块，例如一段阅读材料、图表、案例描述等，被一个或多个连续子题引用。若提供的题目中要求“结合材料作答”“”阅读这篇文章回答以下问题“等，其上文中必定存在对应的背景知识；
      - 若题目明确引用了背景知识（如题目要求“结合材料作答””文章表达了什么中心思想“），但提供的题目中缺失该背景知识，且抄写内容和图片中确实存在对应背景知识，则判定【背景知识是否缺失】为“是”；
      - 如果没有引用背景知识，提供的题目提问意图清晰，作答指令明确，单看题目就可以作答，判定【背景知识是否缺失】为“否”。
      - 作答指令是指题目中给出明确的答题要求，通常比较简短（例如“结合材料作答””选出以下最符合题意的一项“”判断题：“等）；背景知识是一段被引用材料（例如一段新闻稿、一篇文章），本身并不给出明确的答题要求。
    3. <原始完整题目>的定义：
      - 原始完整题目指从抄写内容中截取的、与提供的题目匹配的完整答题单元，包含题干及该题型所必需全部组成部分（如选择题含题干与全部选项、材料题含背景知识与设问等），且内容连贯完整、可独立作答的一段题目文本；
      - 若题目引用了背景知识，原始完整题目必定包含一段背景知识和紧接着的一个或多个连续子题。
    4. 严格以图片展示和抄写的<原始完整题目>为准，找出<提供的题目>中存在的差异：
      - 文字：以图片和抄写内容为准，逐字核对提供的题目找出所有错别字、多余字句、缺漏字句；
      - 强调标记：以图片和抄写内容为准，逐个核对提供的题目中文字下方的横线、波浪线、加点等进行视觉强调标记的位置，同时判断这些被强调的字句与题目作答要求是否有直接关系；
      - 插图：提供的题目使用的插图会统一用<fig>（描述性文本）</fig>格式表示，不需要检查插图。
      - 表：以图片和抄写内容为准，核对提供的题目中的表格格式、文字内容。
    5. 检查一致性步骤：
      - 第一步，在抄写内容中找到提供的题目对应的原始出处，并定位到图片中的位置。
      - 第二步，在抄写内容中检查这道题目的上文，看是否有关联的背景知识，从抄写内容中提取出<原始完整题目>。
      - 第三步，以抄写内容和图片为准，将提供的题目和<原始完整题目>进行仔细对比，找出所有差异的地方。
      - 第四步，根据差异的地方，判断提供的题目和图片展示的<原始完整题目>是否一致，并给出详细判断理由。

    ## **判断一致性原则**
    1. **需要仔细对比的情况**：
      - 在提供的题目中，多余、缺漏字句是否影响题目意图、是否影响题目解答；
      - 在提供的题目中，横线、波浪线、加点字等强调标记是否在正确的位置，例如题目要求填空但缺乏填空的位置，会影响题目解答。
    2. 决定一致性判断的情况：
      - 未在图片以及抄写内容中找到跟提供的题目匹配的内容；
      - 文字增删导致语义变化、知识性术语错误（如“不正确的是”变成“正确的是”）；
      - 与作答要求有直接关系、用于提示答题重点的关键字句，其加点/加粗/下划线等强调标记缺失（如要求解释下划线句子的意思，但题目没有标记句子的位置）；
      - 缺失背景知识，题目缺乏作答必需的背景知识，导致单看题目无法作答（如题目要求结合材料作答，但材料没有给出）；
      - 选择题缺少选项，或者选项内容空白；
      - 填空题缺少下划线或括号标出的填空位置，无法确定填空位置，导致无法作答；
      - 提供的题目被某些文字或符号截断，在图片中通常是题目编号、页眉页脚或水印等文字，导致提供的题目文本不完整不连贯；
      - 提供的题目中存在错别字，与抄写内容和图片中不一致；
      - 存在上述任何一种情况，直接判定【题目和图片是否一致】为“否”。
    3. 不影响一致性判断的轻微差异：
      - 提供的题目要求根据图片或表格作答，即使没有给出对应图片或表格，不影响一致性判断（图表在后续会以别的形式提供给作答者）；
      - 提供的题目缺少题目编号；
      - 多余、缺漏字句但未影响题意，例如多了一个“的”字；
      - 题目前面添加了与题目相关的作答指令，例如选择题前面添加了“从以下选项中选出正确的一项”/判断题前面添加了“判断题：”前缀/填空题前面添加了“根据提示补全语句”等；
      - 横线、波浪线、加点、加粗字体等使用了其他形式进行强调标记，例如使用下划线表示或使用<u></u>标记包围，但都在正确的位置；
      - 横线、波浪线、加点、加粗字体等没有进行强调标记，但与题目作答要求无直接关系，不影响整体题意和题目作答；
      - 若背景知识属于约300字以上的大段长文本，背景知识中存在局部缺漏字句，但不属于与作答要求有直接关系的关键字句，不影响整体题意和题目作答；
      - latex字符渲染方式、标点符号、有无空格或者空格长度不同等轻微差异；
      - 只存在上述的轻微差异，未影响最终题意和作答要求，判定【题目和图片是否一致】为“是”。

    ## 最终输出格式要求：
    【题目和图片是否一致】：是/否，【图片中是否有匹配的题目】: 是/否，【背景知识是否缺失】: 是/否，【题目和图片的差异】: str，【详细判断理由】: str

    **重要提示**：
    严格遵循视觉证据，一切按照图片和抄写截取出来的<原始完整题目>内容为准。
    提供的题目里**肯定跟图片和<原始完整题目>有差异**，不会完全一致，大部分差异都在文字内容上，如实报告所有发现的差异，输出到【题目和图片的差异】。
    有差异不一定会影响一致性，根据**判断一致性原则**进行推理和判断，并输出理由到【详细判断理由】。

    按照指定的步骤一步步执行，严格按照最终输出格式要求给出回复。

    以下是<提供的题目>：
    {query}
    
  template-单轮: |
    你是一个100%严格的判定助手，你的任务是：根据一组图片和一道提供的题目，严格比对题目与图片内容的一致性，按输出格式要求输出判断结果。
    多数情况下，一道题目位于单张图片，但也可能会跨图片出现，按图片顺序连续阅读并准确定位。

    ##注意事项
    1. 若存在以下情况，输出【图片中是否有匹配的题目】为“否”：
      - 在所有图片中均无法找到与提供的题目内容匹配的题目；
      - 题目内容明显被截断（如出现在图片边缘且不完整），且后续图片无延续；
      - 图片变形/模糊/无法识别。
    2. 背景知识/作答指令的定义和处理：
      - 背景知识是指一段背景知识模块，例如一段阅读材料、图表、案例描述等，被一个或多个连续子题引用。若提供的题目中要求“结合材料作答”“”阅读这篇文章回答以下问题“等，其上文中必定存在对应的背景知识；
      - 若题目明确引用了背景知识（如题目要求“结合材料作答””文章表达了什么中心思想“），但提供的题目中未包含该背景知识，且图片中确实存在对应背景知识，则判定【背景知识是否缺失】为“是”；
      - 如果没有引用背景知识，提供的题目提问意图清晰，作答指令明确，单看题目就可以作答，判定【背景知识是否缺失】为“否”。
      - 作答指令是指题目中给出明确的答题要求，通常比较简短（例如“结合材料作答”“选出以下最符合题意的一项”“判断题：”等）；背景知识是一段被引用材料（例如一段新闻稿、一篇文章），本身并不给出明确的答题要求。
    3. **图片展示的完整题目**的定义：
      - 图片展示的完整题目是指图片中展示的、与提供的题目匹配的完整答题单元，包含题干及该题型所必需全部组成部分（如选择题含题干与全部选项、材料题含背景知识与设问等），且内容连贯完整、可独立作答的一段题目文本；
      - 若题目属于背景知识，完整题目必定包含一段背景知识和紧接着的一个或多个连续子题。
    4. 严格按照图片展示的完整题目，找出提供的题目中存在的差异：
      - 文字：以图片为准，逐字核对提供的题目找出所有错别字、缺漏字句；
      - 强调标记：以图片为准，逐个核对提供的题目中文字下方的横线、波浪线、加点等进行视觉强调标记的位置，同时判断这些被强调的字句与题目作答要求是否有直接关系；
      - 插图：提供的题目使用的插图会统一用<fig>（描述性文本）</fig>格式表示，不需要核对插图。
      - 表：以图片为准，核对提供的题目中的表格格式、文字内容。
    5. 检查一致性步骤：
      - 第一步，在一组图片中找到提供的题目对应的原始出处。
      - 第二步，对图片中展示的这道题目，检查上文，看是否有关联的背景知识。
      - 第三步， 以图片为准，将提供的题目和图片中展示的完整题目进行仔细对比，找出所有差异的地方。
      - 第四步，根据差异的地方，判断提供的题目和图片中展示的完整题目是否一致，并给出详细判断理由。

    ## **判断一致性原则**
    1. **需要仔细对比的情况**：
      - 在提供的题目中，错别字、缺漏字句是否影响题目意图、是否影响题目解答；
      - 在提供的题目中，横线、波浪线、加点字等强调标记是否在正确的位置，例如题目要求填空但没有填空的位置，会影响题目解答。
    2. 决定一致性判断的情况：
      - 未在图片中找到跟提供的题目匹配的内容；
      - 文字增删导致语义变化、知识性术语错误（如“不正确的是”变成“正确的是”）；
      - 与作答要求有直接关系、用于提示答题重点的关键字句，其加点/加粗/下划线等强调标记缺失（如要求解释下划线句子的意思，但题目没有标记句子的位置）；
      - 缺失背景知识，题目缺乏作答必需的背景知识，导致单看题目无法作答（如题目要求结合材料作答，但材料没有给出）；
      - 选择题缺少选项，或者选项内容空白；
      - 填空题缺少下划线或括号标出的填空位置，无法确定填空位置，导致无法作答；
      - 提供的题目被某些文字或符号截断，在图片中通常是题目编号、页眉页脚或水印等文字，导致提供的题目文本不完整不连贯；
      - 存在上述任何一种情况，直接判定【题目和图片是否一致】为“否”。
    3. 不影响一致性判断的轻微差异：
      - 提供的题目缺少题目编号；
      - 多字、漏字但未影响题意，例如多了一个“的”字；
      - 题目前面添加了与题目相关的作答指令，例如选择题前面添加了“从以下选项中选出正确的一项”/判断题前面添加了“判断题：”前缀/填空题前面添加了“根据提示补全语句”等；
      - 横线、波浪线、加点、加粗字体等使用了其他形式进行强调标记，例如使用下划线表示或使用<u></u>标记包围，但都在正确的位置；
      - 横线、波浪线、加点、加粗字体等没有进行强调标记，但与题目作答要求无直接关系，不影响整体题意和题目作答；
      - 若背景知识属于约300字以上的大段长文本，背景知识中存在局部缺漏字句，但不属于与作答要求有直接关系的关键字句，不影响整体题意和题目作答；
      - latex字符渲染方式、标点符号、有无空格或者空格长度不同等轻微差异；
      - 只存在上述的轻微差异，未影响最终题意和作答要求，判定【题目和图片是否一致】为“是”。

    ## 最终输出格式要求：
    【题目和图片是否一致】：是/否，【图片中是否有匹配的题目】: 是/否，【背景知识是否缺失】: 是/否，【题目和图片的差异】: str，【详细判断理由】: str

    **重要提示**：
    图片中展示的字词有可能会违反你的知识惯性，**杜绝受常识或认知惯性影响**，严格遵循视觉证据，一切按照图片展示的完整题目的内容为准。
    提供的题目里**肯定跟图片展示有差异**，不会完全一致，大部分差异都在文字内容上，如实报告所有发现的差异，输出到【题目和图片的差异】。
    有差异不一定会影响一致性，根据**判断一致性原则**进行推理和判断，并输出理由到【详细判断理由】。

    按照指定的步骤一步步执行，严格按照最终输出格式要求给出回复。

    提供的题目：
    {query}
